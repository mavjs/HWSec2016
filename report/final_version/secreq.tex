
\section{Security requirements}
%\textcolor{red}{ALL REQUIREMENTS SHOULD BE CHECKED!}

% --- Start of the entire list ---
\begin{enumerate}
% --- Start of Confidentiality ---
\item Confidentiality
	\begin{enumerate}
%	\item The card identity number shall only be revealed to the  personalisation/charging/pump terminal after the terminal has been authenticated to the petrol card.
	\item The certificate and key material shall only be revealed to the IT/CT/PT after the terminal has been authenticated.
	\item The card usage shall not be revealed to any kind of terminal.
	\item The PIN code shall only be know by the petrol card and the petrol card owner. 
	\end{enumerate}
% --- End of Confidentiality ---
%\begin{minipage}{\linewidth}
% --- Start of Integrity ---
\item Integrity
	\begin{enumerate}
	\item The petrol balance on the petrol card can only be altered by an authenticated terminal.
	\item The identity number of the petrol card cannot be altered. 
	\item The certificate and key material on the petrol card and terminals cannot be altered.
	\item The logs on the terminal can only be altered by the terminal itself. 
	\item Communication between the terminals and back-end will be secure after they have both authenticated towards each other.
	\end{enumerate}
% --- End of Integrity ---
%\end{minipage}

% --- Start of Authentication ---
\item Authentication
		\begin{enumerate}
		\item The card owner shall authenticate to the CT or PT by entering the PIN to the petrol card.
	%	\item The charging terminal shall only receive the latest monthly petrol allowance after it has authenticate itself to the back-end %by means of certificates, \textcolor{red}{to receive the monthly petrol allowance that can be written to the petrol cards.REMOVE???}
		\item The back end will only provide the monthly allowance to the CT after it has authenticated itself.

		\item Communication between the terminals and back-end will be secure after they have both authenticated towards each other.
		\end{enumerate}	
		
%\item Authentication during pumping
%	\begin{enumerate}
%	\item The petrol card shall authenticate to the pumping terminal by using its public and private key. % providing its identity number (IDnr).
%	\item The pumping terminal shall authenticate itself to the petrol card by using its public and private keys
%	\item The pumping terminal shall authenticate itself to the back-end by using its public and private keys.

%	\end{enumerate}		
% --- End of Authentication ---

% --- Start of Authorisation ---
\item Authorisation
	\begin{enumerate}
	\item The CT is only authorised to update the petrol allowance to the petrol card once every month.
	\item The PT is authorised to withdraw petrol balance from the petrol card during a petrol transaction.
	\end{enumerate}
% --- End of Authorisation ---


% --- Start of Non-repudiation ---
\item Non-repudiation
	\begin{enumerate}
%		\item The petrol card shall obtain proof that the allowance value came from the back-end via the charging terminal.
%		\item The petrol card shall obtain proof that the changed allowance value came from the pumping terminal.
		\item The CT can prove to the back-end that it charged the monthly allowance to a valid petrol card. 
		\item The PT can prove to the back-end that it collected petrol allowance from a valid petrol card.
	\end{enumerate}
% --- End of Non-repudiation ---

\end{enumerate}
% --- End of the entire list ---
